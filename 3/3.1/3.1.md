# 3.1. Asignación de Responsabilidades

La plataforma InStudio está compuesta por seis módulos principales, cada uno con responsabilidades específicas que contribuyen a su funcionalidad general. A continuación, se describen los módulos y sus respectivas responsabilidades:

## ADR Para Gestión de Reservas

### Contexto

El módulo de Gestión de Reservas es una parte clave de nuestra aplicación web para la reserva de servicios en spas y salones de belleza. Permite a los usuarios visualizar los horarios disponibles y completar el proceso de reserva para los servicios deseados. Además, debe manejar de manera eficiente las solicitudes concurrentes y garantizar la consistencia en el procesamiento de reservas.

#### 1) Titulo: Elección entre Modelo Relacional vs Documental para el Módulo de Gestión de Reservas

El módulo de Gestión de Reservas maneja información sobre horarios y reservas en spas y salones de belleza. La estructura de los datos es relativamente simple, pero puede haber cambios frecuentes en los requisitos de los horarios y reservas. Es importante evaluar si un modelo de datos relacional o documental es más adecuado para este módulo.

#### Alternativas

#### 1.1 Modelo Relacional (PostgreSQL)

- **Ventajas**:
  - Garantiza consistencia y soporte para consultas estructuradas.
  - Maneja relaciones complejas entre entidades, como usuarios y reservas.
  - Ofrece soporte robusto para transacciones y operaciones ACID.

- **Desventajas**:
  - Menos flexible para esquemas cambiantes.
  - Puede ser más complejo de escalar horizontalmente en comparación con soluciones documentales.

#### 1.2 Modelo Documental (MongoDB)

- **Ventajas**:
  - Escalabilidad horizontal para manejar datos no estructurados y esquemas cambiantes.
  - Flexibilidad en la definición del esquema de datos, adaptándose fácilmente a cambios en los requisitos.
  - Ideal para manejar datos que cambian frecuentemente, como horarios de reservas.

- **Desventajas**:
  - Menor consistencia en comparación con bases de datos relacionales.
  - Puede requerir más esfuerzo para implementar transacciones complejas y garantizar integridad de datos.

#### Criterios de Elección

- Flexibilidad en la definición del esquema de datos.
- Requisitos de escalabilidad para manejar grandes volúmenes de datos y consultas.
- Consistencia y soporte para operaciones transaccionales.

#### Decisión

Se elige un modelo documental (MongoDB).

#### Sustento
El modelo documental es más adecuado para manejar los datos del módulo de Gestión de Reservas debido a su flexibilidad para adaptarse a cambios en los horarios y reservas. MongoDB permite que el esquema evolucione si existen requisitos cambiantes, lo que proporciona la escalabilidad necesaria para manejar grandes volúmenes de datos. Aunque un modelo relacional brinda mayor consistencia, la capacidad de escalar horizontalmente y la flexibilidad con MongoDB son más adecuadas para este módulo de reservas.

#### 2) Titulo: Elección entre Sistema de Colas vs Enfoque Basado en Base de Datos para el Manejo de Solicitudes de Reserva

El módulo de Gestión de Reservas maneja múltiples solicitudes concurrentes para reservas en spas y salones de belleza. Es crucial elegir una solución que permita gestionar estas solicitudes de manera eficiente, manteniendo la aplicación receptiva y asegurando la integridad y consistencia de los datos.

####  Alternativas

#### 2.1 Sistema de Colas (RabbitMQ, AWS SQS)

- **Ventajas**:
  - **Procesamiento Asíncrono**: Permite manejar solicitudes de reserva en segundo plano, lo cual ayuda a mantener la aplicación receptiva y a gestionar picos de tráfico sin afectar la experiencia del usuario.
  - **Escalabilidad**: Facilita el manejo de un alto volumen de solicitudes concurrentes, distribuyendo la carga de trabajo de manera eficiente.
  - **Fiabilidad**: Asegura que las reservas se procesen de manera segura y consistente, reduciendo el riesgo de errores en el manejo de reservas y conflictos de datos.
  - **Desacoplamiento**: Permite desacoplar la lógica de procesamiento de reservas de la aplicación principal, facilitando la gestión y mantenimiento del sistema.

- **Desventajas**:
  - **Complejidad Adicional**: Introduce una capa adicional de infraestructura que necesita ser gestionada y mantenida.
  - **Curva de Aprendizaje**: Puede requerir tiempo para que el equipo se familiarice con la configuración y el uso del sistema de colas.

#### 2.2 Enfoque Basado en Base de Datos (Transacciones, Bloqueos)
- **Ventajas**:
  - **Simplicidad**: No requiere la integración de un sistema de colas adicional, utilizando únicamente la base de datos existente para manejar las solicitudes de reserva.
  - **Consistencia**: Utiliza mecanismos de transacción y bloqueo en la base de datos para asegurar la integridad de los datos y evitar conflictos.

- **Desventajas**:
  - **Escalabilidad Limitada**: La base de datos puede convertirse en un cuello de botella bajo altas cargas de trabajo, especialmente si se trata de una base de datos relacional tradicional.
  - **Riesgo de Contención**: El uso intensivo de transacciones y bloqueos puede llevar a problemas de contención y afectar el rendimiento general.
  - **Impacto en la Experiencia del Usuario**: Las solicitudes de reserva pueden afectar la capacidad de respuesta de la aplicación si la base de datos no puede manejar eficazmente el volumen de solicitudes concurrentes.

####  Criterios de Elección
-  Capacidad de manejar altas cargas de trabajo y solicitudes concurrentes.
- Necesidades de procesamiento asíncrono y fiabilidad en la gestión de reservas.
- Simplicidad y mantenimiento de la infraestructura.
- Impacto en el rendimiento y experiencia del usuario.
  
####  Decisión
Se elige utilizar un sistema de colas (RabbitMQ o AWS SQS).

####  Sustento
Un sistema de colas proporciona una solución más robusta para manejar un alto volumen de solicitudes concurrentes al permitir el procesamiento asíncrono y la escalabilidad eficiente. Esto es crucial para mantener la aplicación receptiva durante picos de tráfico y garantizar que las reservas se procesen de manera segura y consistente. Aunque la integración de un sistema de colas introduce complejidad adicional para el equipo de desarrolladores, los beneficios en términos de escalabilidad superan a los de un enfoque basado únicamente en la base de datos (por ejemplo usando una colección "pending"), que podría enfrentar problemas de rendimiento bajo carga elevada.

## **Módulo de Notificaciones**
### Contexto
 Este módulo hace referencia a que las notificaciones serían enviadas a los usuarios cuando un salon de belleza que siguen tiene una nueva oferta y recordatorios de las reservas que tienen.
### Discusión
#### Decisión 1
##### Titulo
- Elección entre lenguaje tipado y lenguaje no tipado
##### Contexto
- El equipo de desarrollo cuenta con experiencia con Python, Java y JavaScript. Y se busca que el modulo presente un buen rendimiento para envíos masivos de notificaciones a cualquier hora del día. Se necesita un desarrollo rápido por el tiempo limitado
##### Alternativas
1. Lenguaje Tipado (Java)
   - Uso explicito de Tipos reduce errores de ejecución
   - Manejo automatico de la memoria
   - Puede ser empleado en distintos tipos de sistemas
2. Lenguaje No Tipado (JavaScript, Python)
   - Flexibilidad y agilidad para desarrollo en proyectos pequeños
   - JavaScript es manejado tanto en el Frontend como Backend
##### Criterios de Evaluación
- Velocidad de desarrollo
- Minimizar el uso distintos de lenguajes en todo el proyecto (Frontend y Backend)
- Compatibilidad con tecnologías actuales
- Contenido de consulta de fácil acceso
##### Decisión Final
- Se elige JavaScript

##### Justificación
- Debido a que se necesita un desarrollo rápido, emplear un lenguaje que todos los miembros del equipo compartan y tengan experiencia con él. Así como es compatible con APIs modernas y tiene gran cantidad de librerias tanto para el backend como el frontend, se eligió Javascript

#### Decisión 2
##### Titulo
- Elección entre almacenamiento SQL o NoSQL
##### Contexto
- Se busca una rápida escritura y lectura de los datos para el envío masivo de notificaciones.
##### Alternativas
1. NoSQL Llave-Valor:
   - Escabilidad: Permite una escalabilidad horizontal (aumentar más servidores)
   - Facilidad: El acceso a la información es simple
   - Rendimiento: Consumen poco por no haber interrelaciones
2. PostgreSQL
   - Escabilidad: Permite una escalabilidad vertical (aumentar potencia)
   - Rendimiento: Excelente para aplicaciones donde se requiere la consistencia de datos, integridad transaccional (ACID), y consultas complejas
   - Facilidad: Usa un lenguaje de consulta que facilita el manejo de los datos

##### Criterios de Evaluación
- Velocidad de acceso
- Flexibilidad para los distintos tipos de notificaciones (ofertas, recordatorios)
- Compatibilidad con tecnologías actuales
- Contenido de consulta de fácil acceso
##### Decisión Final
- Se elige JavaScript

##### Justificación
- Debido a que se necesita un desarrollo rápido por el tiempo limitado, emplear un lenguaje que todos los miembros del equipo compartan y tengan experiencia en él. Así como es compatible con APIs modernas y tiene gran cantidad de librerias tanto para el backend como el frontend, se eligió Javascript

3. **Módulo de Ofertas**: Este módulo hace referencia a que los salones de belleza puedan crear y gestionar promociones y ofertas especiales para atraer más clientes. Los salones pueden definir ofertas con fechas de inicio y fin, aplicar descuentos y establecer condiciones especiales.



## ADR para el Módulo de Analíticas

### Contexto

El módulo de analíticas se encarga de recopilar y almacenar métricas y datos, como la cantidad de visualizaciones, reservas, entre otros. El sistema debe manejar un gran volumen de datos en tiempo real, ya que cada acceso a la página genera una nueva entrada.


#### 1) Titulo: Elección entre base de datos SQL y NoSQL
El módulo de analíticas necesita almacenar grandes volúmenes de datos sobre las vistas de página para cada salón de belleza.

## ADR Generales

**1) Título: Elección entre arquitectura de Microservicios vs Monolítica**

**Contexto**:
- InStudio tendrá que soportar un crecimiento constante de usuarios y transacciones. Deberá contar con flexibilidad para agregar funcionalidades o módulos nuevos, y la capacidad de escalar individualmente en base a la demanda. También se debe asegurar la continuidad del servicio al realizar actualizaciones.

**Alternativas**:  
1. **Arquitectura Monolítica**  
   - Despliegue completo de la plataforma.
   - Fácil de implementar y administrar.
   - Menor complejidad en la etapa inicial de desarrollo.
   - Separación confusa entre módulos.

2. **Arquitectura de Microservicios**  
   - Separación clara entre módulos.
   - Cada módulo puede escalar individualmente.
   - Facilidad para desarrollo y despliegue por separado.
   - Mayor complejidad en la etapa inicial de desarrollo.
   - Permite seleccionar diferentes tecnologías por cada módulo de acuerdo a su necesidad. 

**Criterios de Elección**:  
- Facilidad para desarrollo y despliegue por separado.
- Flexibilidad para cambios rápidos en los módulos de la plataforma.
- Escalar de manera independiente cada módulo .

**Decisión**:  
- Se elige la arquitectura de microservicios.

**Sustento**:  
- La escalabilidad y flexibilidad son importantes para la plataforma. Al dividir los módulos en servicios independientes, es posible escalar cada uno de manera individual, lo que permite optimizar los recursos de forma más eficiente.
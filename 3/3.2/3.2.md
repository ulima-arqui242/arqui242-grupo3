# 3.2. Modelo de Coordinación

En la plataforma InStudio, el modelo de coordinación define cómo los módulos del sistema se comunican entre sí y con sistemas externos. Se utilizará un enfoque basado en microservicios con comunicación asíncrona mediante Apache Kafka

La comunicación síncrona dentro de InStudio se realizará mediante servicios HTTP/REST utilizando NestJS. Este enfoque permite la interacción directa entre los módulos a través de API RESTful. Asimismo, la comunicación asíncrona se gestionará mediante un enfoque de microservicios y Apache Kafka. Kafka, como sistema de mensajería distribuido, permitirá una comunicación entre los distintos microservicios, para facilitar el manejo de eventos.
Asimismo, InStudio integrará servicios externos mediante APIs de terceros y servicios en la nube para funciones específicas. Por ejemplo el manejo de colas en AWS y las APIs de AWS Lambda para el manejo de serverless. Además de el manejo de APIs para realizar pagos en la plataforma como Stripe.

## ADR 1: Elección entre Arquitectura Monolítica vs Microservicios

### Contexto
La plataforma InStudio requiere una solución que permita una gestión eficiente de reservas, comunicación entre módulos y escalabilidad a medida que la plataforma crece. Es crucial decidir entre una arquitectura monolítica y una basada en microservicios.

### Alternativas
  1) **Arquitectura Monolítica**
     
  Ventajas:
    - Simplicidad en el Desarrollo: Una única base de código y despliegue simplifica el proceso de desarrollo y despliegue.
    - Menor Complejidad Inicial: Ideal para proyectos más pequeños o menos complejos.
    - Despliegue Unificado: Todos los componentes se despliegan juntos, lo que simplifica la gestión de versiones.
    
  Desventajas:

    - Escalabilidad Limitada: Dificultad para escalar partes específicas del sistema de manera independiente.
    - Acoplamiento: Componentes estrechamente acoplados pueden dificultar la evolución y el mantenimiento.
    - Impacto en Despliegues: Cambios en una parte del sistema requieren el redepliegue completo de la aplicación.

  2) **Arquitectura de Microservicios**

    Ventajas:
    - Escalabilidad Independiente: Permite escalar servicios específicos según la demanda.
    - Desacoplamiento: Cada microservicio puede ser desarrollado, desplegado y escalado de forma independiente.
    - Flexibilidad Tecnológica: Posibilidad de utilizar diferentes tecnologías para distintos microservicios.
    
    Desventajas:
    - Complejidad: Aumenta la complejidad en la gestión y coordinación entre servicios.
    - Requisitos de Infraestructura: Necesita herramientas adicionales para despliegue, monitoreo y gestión.
    - Comunicación: Requiere una infraestructura robusta para la comunicación entre microservicios.
    - Criterios de Elección
    - Escalabilidad y flexibilidad.
    - Complejidad en la gestión y despliegue.
    - Capacidad de adaptación a cambios y crecimiento.
    - Impacto en el rendimiento y mantenimiento del sistema.
    
### Decisión
Se elige la Arquitectura de Microservicios.

### Criterios de Elección

- Escalabilidad y flexibilidad.
- Complejidad en la gestión y despliegue.
- Capacidad de adaptación a cambios y crecimiento.
- Impacto en el rendimiento y mantenimiento del sistema.

### Sustento
La arquitectura de microservicios proporciona la flexibilidad y escalabilidad necesarias para gestionar el crecimiento y la evolución de la plataforma InStudio. Aunque introduce complejidad adicional, sus beneficios en términos de escalabilidad independiente y desacoplamiento se considera importante para el manejo de los múltiples módulos. La capacidad para utilizar diferentes tecnologías y escalar componentes específicos según la demanda supera las limitaciones de un enfoque monolítico.


## ADR 2: Elección entre Apache Kafka vs Alternativas de Mensajería Asíncrona

### Contexto
Para la comunicación asíncrona entre los microservicios de InStudio, se requiere seleccionar un sistema de mensajería que permita una gestión eficiente de eventos y solicitudes concurrentes. Es crucial evaluar Apache Kafka frente a otras soluciones de mensajería.

### Alternativas
  1) **Apache Kafka**
     
    Ventajas:
    - Alta Escalabilidad: Soporta un alto volumen de mensajes y eventos, permitiendo una escalabilidad horizontal eficaz.
    - Desacoplamiento: Facilita la comunicación asíncrona entre microservicios, desacoplando productores y consumidores de eventos.
    - Persistencia y Durabilidad: Ofrece almacenamiento duradero de mensajes, permitiendo la recuperación y reprocessamiento de eventos.
      
    Desventajas:
    - Complejidad: Configuración y mantenimiento de Kafka puede ser complejo.
    - Requerimientos de Recursos: Necesita recursos adicionales para operar y mantener el clúster de Kafka.

  2) **RabbitMQ**

    Ventajas:
    - Facilidad de Uso: Más fácil de configurar y administrar en comparación con Kafka.
    - Flexibilidad de Enrutamiento: Proporciona capacidades avanzadas de enrutamiento y patrones de consumo de mensajes.
    
    Desventajas:
    - Escalabilidad Limitada: Menos eficiente en el manejo de grandes volúmenes de mensajes y alta concurrencia.
    - Persistencia: La persistencia de mensajes es menos robusta en comparación con Kafka.
    
### Criterios de Elección

- Escalabilidad y rendimiento.
- Complejidad en la configuración y mantenimiento.
- Flexibilidad en el manejo de mensajes y eventos.
- Costos operativos y recursos necesarios.
  
### Decisión
Se elige Apache Kafka como sistema de mensajería asíncrona.

### Sustento
Apache Kafka es la mejor opción porque maneja grandes volúmenes de mensajes de manera eficiente y asegura que los mensajes se conserven y puedan recuperarse fácilmente. Aunque es más complejo y requiere más recursos, su capacidad de escalar y gestionar eventos asíncronos supera a otras opciones como RabbitMQ. Kafka es más adecuado para una plataforma en crecimiento como InStudio.





